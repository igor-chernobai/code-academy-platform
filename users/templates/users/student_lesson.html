{% extends 'base.html' %}
{% load static %}

{% block content %}

  <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-[280px_1fr] min-h-screen pt-17">
    <aside class="hidden lg:block  border-r border-gray-200">
      <div class="sticky top-17 h-[calc(100vh-5rem)] overflow-y-auto py-10 sm:px-4 pr-8">
        {% for module in course.modules.all %}
          <div class="mb-4">
            <h3 class="text-xs font-semibold text-[#539db8] uppercase tracking-wider mb-3">
              {{ module.title }}
            </h3>

            {% for l in module.lessons.all %}
              <a href="{% url 'users:student_course_lesson' course.id l.slug %}"
                 class="block px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 mb-1
                      {% if l == lesson %}
                        bg-[#ff9d32] text-white font-semibold shadow-sm
                      {% else %}
                        text-gray-700 hover:bg-gray-200
                      {% endif %}">
                {{ l.title }}
              </a>
            {% endfor %}
          </div>
        {% endfor %}
      </div>
    </aside>

    <main class="px-6 py-12 lg:px-20 lg:py-10 max-w-5xl mx-auto w-full">
      <h1 class="text-4xl lg:text-5xl font-bold text-[#010114] mb-6 leading-tight">
        {{ lesson.title }}
      </h1>

      <article class="prose prose-lg max-w-none text-[#010114]/85 leading-relaxed">
        {{ lesson.content_formatted|safe }}
      </article>

      <div class="flex justify-end">
        <form action="{% url 'users:lesson_complete' %}" method="post">
          {% csrf_token %}
          {{ lesson_complete_form.as_p }}
          <button class="block px-5 py-2 rounded-xl bg-[#ff9d32] text-white font-semibold shadow-sm cursor-pointer">
            {% if lesson.get_next %}
              Наступна лекція
            {% else %}
              Завершити курс
            {% endif %}
          </button>
        </form>
      </div>
    </main>
  </div>

{% endblock %}