{% extends "base.html" %}
{% load static %}

{% block content %}

  <div class="flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-sm sm:max-w-md p-8 bg-white rounded-xl shadow-2xl">

      {# Перевірка, чи дійсне посилання #}
      {% if validlink %}

        <h2 class="text-3xl font-extrabold text-center text-gray-800 mb-6">
          Встановлення нового пароля
        </h2>

        <p class="text-gray-600 mb-8 text-center">
          Будь ласка, введіть новий пароль двічі для підтвердження.
        </p>

        <form method="post" class="space-y-6">
          {% csrf_token %}

          {# Загальні помилки форми #}
          {% if form.non_field_errors %}
              <div class="p-3 text-sm text-red-700 bg-red-100 rounded-lg" role="alert">
                  {% for error in form.non_field_errors %}
                      <p>{{ error }}</p>
                  {% endfor %}
              </div>
          {% endif %}

          {# Поле 1: Новий пароль #}
          <div class="form-group">
            <label for="{{ form.new_password1.id_for_label }}"
                   class="block text-sm font-medium text-gray-700 mb-1">
                Новий пароль:
            </label>
            {{ form.new_password1 }}
            {% if form.new_password1.errors %}
                <p class="mt-1 text-sm text-red-600">{{ form.new_password1.errors.as_text }}</p>
            {% endif %}
          </div>

          {# Поле 2: Підтвердження пароля #}
          <div class="form-group">
            <label for="{{ form.new_password2.id_for_label }}"
                   class="block text-sm font-medium text-gray-700 mb-1">
                Підтвердіть пароль:
            </label>
            {{ form.new_password2 }}
            {% if form.new_password2.errors %}
                <p class="mt-1 text-sm text-red-600">{{ form.new_password2.errors.as_text }}</p>
            {% endif %}
          </div>

          {# Кнопка відправлення #}
          <div class="submit-row pt-4">
            <input type="submit" value="Змінити пароль"
                   class="w-full py-3 px-5 text-lg font-black uppercase tracking-widest text-white bg-[#19183B] rounded-xl cursor-pointer
                          hover:bg-[#ff9d32] hover:text-white hover:shadow-xl hover:shadow-[#ff9d32]/40
                          transition-all duration-300 ease-in-out">
          </div>
        </form>

      {% else %}

        <h2 class="text-3xl font-extrabold text-center text-red-600 mb-6">
          Помилка скидання пароля
        </h2>

        <p class="text-gray-600 mb-8 text-center">
          Посилання для скидання пароля недійсне, можливо, воно вже було використане. Будь ласка, повторно запитайте скидання пароля.
        </p>

        <a href="{% url 'password_reset' %}"
           class="w-full inline-block py-3 px-5 text-lg font-black uppercase tracking-widest text-white bg-gray-500 rounded-xl
                  hover:bg-gray-700 transition-all duration-300 ease-in-out">
          Запросити нове скидання
        </a>

      {% endif %}

    </div>
  </div>

{% endblock %}
